<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="技术,小说,随笔,Hexo" />
  <meta name="author" content="井月轩" />
  <meta name="subtitle" content="内涵胖子 拒绝减肥" />  
  <meta name="description" content="技术、随笔、吐槽" />
  <meta name="msvalidate.01" content="4504B006DB2A6062F644FCDD2FC0575B" />
  <title>Hexo的美化、优化以及Lighthouse极致追分 | 井说</title>
  <link rel="apple-touch-icon" href="https://s2.loli.net/2022/12/30/lV2YzG9s86yK3OB.jpg">
  <link rel="icon" href="https://s2.loli.net/2022/12/30/lV2YzG9s86yK3OB.jpg">
  <!-- jquery3.6 -->
  <script async src="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.4/source/js/jquery.min-3.6.js"></script>
  <!-- hexo site css -->
  <link async href="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.5/source/css/base-min.css" rel="stylesheet">
  <link async href="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.4/source/iconfont/iconfont-min.css" rel="stylesheet">
  <link async href="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.4/source/css/github-markdown-min.css" rel="stylesheet">
  <link async href="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.4/source/css/highlight-min.css" rel="stylesheet">  
  <!-- fancybox -->
  <link async href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" rel="stylesheet">  
  <script async src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>
  <script async src="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.4/source/js/fancybox.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R4XRTRGM56"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-R4XRTRGM56');
    </script>  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="井说" type="application/atom+xml">
</head>
<body>
  <div id="app">
  <div class="header">
  <div class="avatar">
    <a href="https://www.igerm.ee"><img src="https://s2.loli.net/2022/12/30/lV2YzG9s86yK3OB.jpg" alt=""></a>
  </div>
  <div class="navbar">
    <ul>
      <li class="nav-item" data-path="/"><a href="/">经验</a></li>
      <li class="nav-item" data-path="/categories/essay/"><a href="/categories/essay/">随笔</a></li>
      <li class="nav-item" data-path="/categories/novel/"><a href="/categories/novel/">小说</a></li>
      <li class="nav-item" data-path="/about/"><a href="/about/">关于</a></li>
    </ul>
  </div>
</div>
<script>
  let navs = document.querySelectorAll('.nav-item');
  let pagePath = window.location.pathname;
  for (let nav of navs) {
    let navPath = nav.getAttribute("data-path");
    if (navPath && navPath === pagePath) {
      nav.className = "nav-item active";
    }
  }
</script>       
  <div class="flex-container">          
  <!-- 同时引入 post.ejs 和 index.ejs -->
  
<div class="container post-details" id="post-details">
  <div class="post-content">
    <div class="post-title">Hexo的美化、优化以及Lighthouse极致追分</div>
    <div class="post-attach">
      <span class="post-pubtime">
        <i class="iconfont icon-edit" title="更新时间"></i> 2021-04-04 10:28
      </span>
      <span class="post-count">≈ 2.4k字</span>
      <span class="post-count">≈ 10分钟</span>
    </div>
    <div class="markdown-body"><p>之前写过一篇 <a href="https://www.igerm.ee/experience/Hexo-Github-Page/">利用Hexo、GitHub Page、Typora写文章</a>详细分享了我安装Hexo的过程，今天来聊一聊我这几天做文章迁移，选择Hexo主题，以及做主题修改和Hexo分页修改的过程，最后还会简单说一下如何在Lighthouse达到100分的跑分</p>
<h2 id="Hexo美化"><a href="#Hexo美化" class="headerlink" title="Hexo美化"></a>Hexo美化</h2><p>首先，Hexo安装完毕之后目前默认的是<code>landscape</code>这个主题，也很简洁，专注于写文章的人直接用完全没问题。不过我之前在使用Halo的时候用的就是<a target="_blank" rel="noopener" href="https://theme-next.iissnan.com/">Next主题</a>，因此这次迁移第一个想法就是仍然使用<code>next</code></p>
<h3 id="主题安装"><a href="#主题安装" class="headerlink" title="主题安装"></a>主题安装</h3><p>有意思的是我没有直接搜索<code>next</code>，而是在<a target="_blank" rel="noopener" href="https://hexo.io/themes/">Hexo的官方主题库</a>里面想要找到<code>next</code>，我想这是一种缘分，让我发现了Oranges这个主题，可以看一下<a target="_blank" rel="noopener" href="https://hexo.theme.oranges.zcheng.site/">Demo</a>，这个主题比<code>next</code>还要简洁</p>
<p><img src="https://images.igerm.ee/myimages/20250214171804304.png" alt="image-20210404103130252"></p>
<p>去掉了所有可变按钮和分栏，这样就带来一个好处，移动端的时候选择其他标签按钮不需要再点一个下拉菜单了，就这一点点的简化让我选择了<a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">这个主题</a></p>
<p>安装过程很简单，只有两个步骤：</p>
<ol>
<li><p><code>$ git clone https://github.com/zchengsite/hexo-theme-oranges.git themes/oranges</code></p>
</li>
<li><p>修改hexo根目录的<code>_config.yml</code> 文件，把<code>theme</code>改成<code>oranges</code>即可</p>
</li>
</ol>
<h3 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h3><p>在正式使用主题之前，还可以基于主题进行一些个性化配置，看得出来作者对于一些功能的开启有着很严格的标准，基本上在Readme文件当中罗列的功能都是基本需要的，可以在<a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges/blob/master/README-zh.md#%E9%85%8D%E7%BD%AE">这里查看</a>，由于作者的文档非常详细了，就不额外罗列了，我只简单说一下我开启的功能：</p>
<p>分类、标签、文章目录、RSS、评论、Google Analytics、上下页、全文搜索</p>
<p>图片懒加载没有开启，主要是觉得本来图片已经用了图床+CDN了，再多一个懒加载多此一举，而且观感不太好，要先看一个未加载的图片</p>
<h3 id="主题修改"><a href="#主题修改" class="headerlink" title="主题修改"></a>主题修改</h3><p>下面来聊一聊我改动了哪些地方，比较碎，咱们一点一点说</p>
<h4 id="footer当中添加邮箱识别"><a href="#footer当中添加邮箱识别" class="headerlink" title="footer当中添加邮箱识别"></a>footer当中添加邮箱识别</h4><p><img src="https://images.igerm.ee/myimages/20250214171811828.png" alt="image-20210404104415928"></p>
<p>在这里的所有图标都对应一个网址，因此作者在处理的时候就直接将配置文件的地址写入<code>&lt;a&gt;</code>标签的<code>href</code>里面了，但是作为邮箱，是需要在<code>href</code>里面加上一个<code>mailto:</code>的，可是由于里面有一个<code>:</code>的原因，直接写在配置文件里面会报错，因此我修改了代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;social&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      &lt;% for(let item of theme.footer.social)&#123; %&gt;</span><br><span class="line">        &lt;% if (item.name == &quot;email&quot;) &#123; %&gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">title</span>=<span class="string">&quot;&lt;%- item.name %&gt;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mailto:&lt;%- item.path %&gt;&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-&lt;%- item.icon %&gt;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;% &#125; else &#123; %&gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">title</span>=<span class="string">&quot;&lt;%- item.name %&gt;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%- item.path %&gt;&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-&lt;%- item.icon %&gt;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &lt;% &#125; %&gt;</span><br><span class="line">      &lt;% &#125; %&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  &lt;% for(let item of theme.footer.more)&#123; %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;footer-more&quot;</span>&gt;</span></span><br><span class="line">      &lt;% if (item.path) &#123; %&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%- item.path %&gt;&quot;</span>&gt;</span>&lt;%- item.name %&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      &lt;% &#125; else &#123; %&gt;</span><br><span class="line">        &lt;%- item.name %&gt;</span><br><span class="line">      &lt;% &#125; %&gt;  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  &lt;% &#125; %&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当配置文件里面的社交名为<code>email</code>的时候，在代码里面添加<code>mailto:</code></p>
<h4 id="首页文章列表去掉某个分类"><a href="#首页文章列表去掉某个分类" class="headerlink" title="首页文章列表去掉某个分类"></a>首页文章列表去掉某个分类</h4><p>这个需求我不知道其他人有没有，因为我的博客里面除了技术的文章，还会放一些小说，以及每日一段话类似之前的说说，全都堆在首页列表里面显得非常混乱，因此我修改了代码，将某个分类从列表中去掉（去掉几个都无所谓），代码改动不多，但是结构比较复杂，所以我把index.ejs全部贴出来，你们想要改的话直接复制就好，然后再手动改第11行即可</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container index&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;post-list&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 遍历渲染文章 --&gt;</span></span><br><span class="line">    &lt;% </span><br><span class="line">    var prev = -10086;// prev year</span><br><span class="line">    var curr;// curr year, ever step be updated </span><br><span class="line"></span><br><span class="line">    page.posts.forEach(function(item) &#123; </span><br><span class="line">      var mark = true;</span><br><span class="line">      item.categories.forEach(function(item1)&#123;</span><br><span class="line">        if(item1.name == &quot;novel&quot; || item1.name == &quot;gossip&quot;)&#123;</span><br><span class="line">          mark = false;</span><br><span class="line">        &#125;          </span><br><span class="line">      &#125;);</span><br><span class="line">      if(mark)&#123;</span><br><span class="line">        curr = item.date.year()</span><br><span class="line">        if (curr !== prev) &#123;</span><br><span class="line">          prev = curr;</span><br><span class="line"></span><br><span class="line">    %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content-title&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&lt;%- curr %&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &lt;%</span><br><span class="line">      &#125;</span><br><span class="line">    %&gt;</span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;post-item&quot;</span> <span class="attr">title</span>=<span class="string">&quot;&lt;%- item.title %&gt;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;time-m-d&quot;</span>&gt;</span>&lt;%- item.date.format(&quot;MM-DD&quot;) %&gt;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%- url_for(item.path) %&gt;&quot;</span>&gt;</span></span><br><span class="line">            &lt;% if(item.title !== &quot;&quot;) &#123; %&gt;</span><br><span class="line">              &lt;% if (item.top) &#123; %&gt;</span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">title</span>=<span class="string">&quot;&lt;%= __(&#x27;pinned&#x27;) %&gt;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon iconfont icon-pin-top post-top&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>&lt;%- item.title %&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              &lt;% &#125; else &#123; %&gt;</span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>&lt;%- item.title %&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              &lt;% &#125; %&gt;</span><br><span class="line">            &lt;% &#125; else &#123; %&gt;</span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span>&gt;</span>untitled<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            &lt;% &#125; %&gt;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &lt;% &#125;&#125;) %&gt;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;post-navigation&quot;</span>&gt;</span></span><br><span class="line">    &lt;% if(page.prev !== 0)&#123; %&gt;</span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%- url_for(page.prev_link)%&gt;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-angleleft&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;page-num&quot;</span>&gt;</span>&lt;%- page.current %&gt; / &lt;%- page.total -%&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    &lt;% if(page.next !== 0)&#123; %&gt;</span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%- url_for(page.next_link)%&gt;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-angleright&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>和主题原本不一样的是，我在列表当中将年度提取出来单独展示，这样观感好一些，当然也是从归档页抄来的</p>
<p><img src="https://images.igerm.ee/myimages/20250214171819655.png" alt="image-20210404105509804"></p>
<h4 id="修改hexo-generator-index分页"><a href="#修改hexo-generator-index分页" class="headerlink" title="修改hexo-generator-index分页"></a>修改hexo-generator-index分页</h4><p>需要注意的是，除非你不用分页（似乎不太可能），如果使用系统分页，那么系统自己再分页的时候，是不会把你想要去除的文章去掉的，这会导致一个问题，就是比如你按10个文章一分，但是主页只显示7个文章，那么分页后这个页面就是7个文章，如果正好某一页全都是你要去除的文章，那么这个页面上就会什么都没有，这和我们的初衷相违背，因此我们想要达到更好的观感，也需要修改Hexo的分页程序</p>
<p>修改的位置就在你博客的根目录<code>node_modules</code>文件夹里面，找到<code>hexo-generator-index</code>这个文件夹当中的<code>generator.js</code>这个文件，用<code>vscode</code>或者记事本打开也可以，在文章数组生成后，调用分页函数之前，添加一段代码，我的方法是新建一个数组，然后将老数组加一个判断，将未排除的文章推入新的数组即可，代码如下，改动从第16行开始</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pagination = <span class="built_in">require</span>(<span class="string">&#x27;hexo-pagination&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; sort &#125; = <span class="built_in">require</span>(<span class="string">&#x27;timsort&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params">locals</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> config = <span class="variable language_">this</span>.<span class="property">config</span>;</span><br><span class="line">  <span class="keyword">const</span> posts = locals.<span class="property">posts</span>.<span class="title function_">sort</span>(config.<span class="property">index_generator</span>.<span class="property">order_by</span>);</span><br><span class="line">  <span class="keyword">const</span> temp_posts = [];</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sort</span>(posts.<span class="property">data</span>, <span class="function">(<span class="params">a, b</span>) =&gt;</span> (b.<span class="property">sticky</span> || <span class="number">0</span>) - (a.<span class="property">sticky</span> || <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> paginationDir = config.<span class="property">pagination_dir</span> || <span class="string">&#x27;page&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> path = config.<span class="property">index_generator</span>.<span class="property">path</span> || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(config.<span class="property">index_generator</span>.<span class="property">exclude</span>)&#123;    </span><br><span class="line">    posts.<span class="title function_">forEach</span>(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> mark=<span class="literal">true</span>; </span><br><span class="line">      element.<span class="property">categories</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">categories</span>)&#123; </span><br><span class="line">        config.<span class="property">index_generator</span>.<span class="property">exclude_list</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">category</span>)&#123;</span><br><span class="line">          <span class="keyword">if</span>(categories.<span class="property">name</span> == category)&#123;</span><br><span class="line">            mark=<span class="literal">false</span>; </span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;); </span><br><span class="line">      <span class="keyword">if</span>(mark)&#123;</span><br><span class="line">        temp_posts.<span class="title function_">push</span>(element);</span><br><span class="line">      &#125;    </span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">pagination</span>(path, config.<span class="property">index_generator</span>.<span class="property">exclude</span> ? temp_posts : posts, &#123;</span><br><span class="line">    <span class="attr">perPage</span>: config.<span class="property">index_generator</span>.<span class="property">per_page</span>,</span><br><span class="line">    <span class="attr">layout</span>: [<span class="string">&#x27;index&#x27;</span>, <span class="string">&#x27;archive&#x27;</span>],</span><br><span class="line">    <span class="attr">format</span>: paginationDir + <span class="string">&#x27;/%d/&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">__index</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>然后在系统的配置文件<code>_config.yml</code>里面添加要排除的分类名称</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br><span class="line">  <span class="attr">exclude:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude_list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">novel</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">gossip</span></span><br></pre></td></tr></table></figure>

<p>到这里，基本上有关视觉的改动就差不多了</p>
<h3 id="快！一定要快"><a href="#快！一定要快" class="headerlink" title="快！一定要快"></a>快！一定要快</h3><p>接下来，我修改的部分主要是为了打开速度，既然选择了这么简洁的主题，那么<code>Lighthouse</code>跑分跑不到100分多丢人？ 下面是<a href="https://www.igerm.ee/">我的主页</a>的跑分，包括桌面端和移动端</p>
<p><img src="https://images.igerm.ee/myimages/20250214171827507.png"></p>
<p><img src="https://images.igerm.ee/myimages/20250214171834809.png"></p>
<p>要怎么做呢，其实google给出了很多建议，这里我只说一下我针对主题的一些做法</p>
<h4 id="将所有静态文件保存在CDN"><a href="#将所有静态文件保存在CDN" class="headerlink" title="将所有静态文件保存在CDN"></a>将所有静态文件保存在CDN</h4><p>方法也很简单，将主题目录上传到<code>github</code>的一个公共仓库，然后发布一个<code>release</code>版本，这样你这个版本里面的静态文件都会缓存到jsdelivr里面，调用的方法也很简单</p>
<p><code>https://cdn.jsdelivr.net/gh/你的用户名/你的仓库名@Release版本号/source/iconfont/iconfont-min.css</code></p>
<h4 id="将js文件异步加载"><a href="#将js文件异步加载" class="headerlink" title="将js文件异步加载"></a>将js文件异步加载</h4><p>有了CDN地址之后，将主题里面所有的资源都改用CDN，主要是在<code>/layout/_partial/header.ejs</code>里面，还有几个零散的地方，自己看下<code>source/*</code>里面的文件，有哪些要修改的改下就可以了，<code>Lighthouse</code>跑一下也会有对应的提示，记得将所有的<code>js</code>文件的加载都添加<code>async</code>关键字，<code>jquery.min</code> 在这里是为了全文搜索使用的，加载的时候不涉及，<code>jquery.fancybox.min-3.5.2</code> 在这里是为了文章点击图片放大使用，也不涉及到一开始的页面渲染，所以放心加没关系，不要让这些<code>js</code>文件阻碍页面渲染</p>
<h4 id="将所有js和css文件都进行压缩"><a href="#将所有js和css文件都进行压缩" class="headerlink" title="将所有js和css文件都进行压缩"></a>将所有js和css文件都进行压缩</h4><p>这个是标准动作啦，直接搜索css压缩，会有很多在线压缩的网站，将文件复制进去点一下压缩，再创建一个<code>XX-min.js</code>的文件保存就可以了</p>
<p>至此经过一顿折腾，我的页面桌面模拟100分，移动端模拟99分，当然还有进步的空间，只是日后有机会再折腾吧</p>
</div>
      
        <div class="prev-or-next">
          <div class="post-foot-prev">
              <a href="/experience/Hexo%E5%85%A8%E6%96%87%E6%90%9C%E7%B4%A2%E5%9C%B0%E5%9D%80%E9%94%99%E8%AF%AF/" target="_self">
                <i class="iconfont icon-chevronleft"></i>  
                <span>Hexo全文搜索地址错误</span> 
              </a>
          </div>
          <div class="post-foot-next">
              <a href="/experience/Hexo-Github-Page/" target="_self">
                <span>利用Hexo、GitHub Page、Typora写文章</span>
                <i class="iconfont icon-chevronright"></i>             
              </a> 
          </div>
        </div>
      
    </div>
    
<div class="post-catalog" id="catalog">
  <div class="title">目录</div>
  <div class="catalog-content">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hexo%E7%BE%8E%E5%8C%96"><span class="toc-text">Hexo美化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%A2%98%E5%AE%89%E8%A3%85"><span class="toc-text">主题安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE"><span class="toc-text">主题配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%A2%98%E4%BF%AE%E6%94%B9"><span class="toc-text">主题修改</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#footer%E5%BD%93%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%82%AE%E7%AE%B1%E8%AF%86%E5%88%AB"><span class="toc-text">footer当中添加邮箱识别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E6%96%87%E7%AB%A0%E5%88%97%E8%A1%A8%E5%8E%BB%E6%8E%89%E6%9F%90%E4%B8%AA%E5%88%86%E7%B1%BB"><span class="toc-text">首页文章列表去掉某个分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9hexo-generator-index%E5%88%86%E9%A1%B5"><span class="toc-text">修改hexo-generator-index分页</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%EF%BC%81%E4%B8%80%E5%AE%9A%E8%A6%81%E5%BF%AB"><span class="toc-text">快！一定要快</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E6%89%80%E6%9C%89%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E4%BF%9D%E5%AD%98%E5%9C%A8CDN"><span class="toc-text">将所有静态文件保存在CDN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86js%E6%96%87%E4%BB%B6%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD"><span class="toc-text">将js文件异步加载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E6%89%80%E6%9C%89js%E5%92%8Ccss%E6%96%87%E4%BB%B6%E9%83%BD%E8%BF%9B%E8%A1%8C%E5%8E%8B%E7%BC%A9"><span class="toc-text">将所有js和css文件都进行压缩</span></a></li></ol></li></ol></li></ol>
  </div>
</div>
<script async src="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.4/source/js/catalog.js"></script>


    <div class="comments-container">
  <script src="https://utteranc.es/client.js"
        repo="wellmoonloft/repo_wellmoonloft"
        issue-term="pathname"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
  </script>
</div>
  </div>

  <div class="footer">
  <div class="social">
    <ul>
      <li><a title="rss" href="/atom.xml"><i class="iconfont icon-rss"></i></a></li>
    </ul>
  </div>
  <div class="footer-more">
      <a href="https://www.igerm.ee">Copyright © wellmoonloft 2025</a>  
  </div><div class="footer-more">
      <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges ｜ Powered by Hexo</a>  
  </div>
</div>
  </div>
  <div style="position: fixed;right: 2.2rem;top: 2.2rem;font-weight: bold;font-size: 1.6rem;">
  <a href="https://www.igerm.ee"> CN</a>
  <a href="https://www.igerm.ee/jp"> JP</a>
  <a href="https://www.igerm.ee/en"> EN</a>
  </div><div class="back-to-top hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>
<script async src="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.4/source/js/backtoTop.js"></script>
  <div class="search-icon" id="search-icon">
    <a href="javascript: void(0)"><i class="iconfont icon-search"></i></a>
  </div>
  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)"><i class="iconfont icon-search"></i></a>
        </span><input type="text" class="search-input" id="search-input" placeholder="搜索...">
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)"><i class="iconfont icon-close"></i></a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>
  <script async src="https://cdn.jsdelivr.net/gh/wellmoonloft/peach@v0.1.6/source/js/search.js"></script>
  </div>
</body>
</html>